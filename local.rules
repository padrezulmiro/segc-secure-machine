$Id: local.rules,v 1.11 2004/07/23 20:15:44 bmc Exp $
# ----------------
# LOCAL RULES
# ----------------
# This file intentionally does not come with signatures.  Put your local
# additions here.

alert tcp any any -> 10.101.204.4 0:1023 (msg:"NMAP TCP PORT SCAN"; detection_filter: track by_dst, count 5, seconds 60; sid:1000001; rev:1;)
event_filter gen_id 1, sig_id 1000001, type limit, track by_src, count 1, seconds 60

# Detect
alert tcp !10.101.204.4 any -> 10.101.204.4 any (msg:"Possible IoTDevice DoS attack detected"; flow: stateless; detection_filter: track by_src, count 4, seconds 15; sid:1000002; rev:1;)

# Limit alerts
event_filter gen_id 1, sig_id 1000002, type limit, track by_src, count 1, seconds 15
